(()=>{var e={};e.id=246,e.ids=[246],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4231:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>q});var a=s(687),t=s(3210),n=s(1423),l=s(9667),i=s(9523),d=s(6834),o=s(5079),c=s(3184),u=s(7605),m=s(3442),x=s(8693),p=s(4050),h=s(3503),g=s(13),b=s(9867),j=s(4957),y=s(2185),f=s(9005);function v({isOpen:e,onClose:r,product:s}){let{toast:n}=(0,b.dj)(),{user:d}=(0,j.A)(),o=(0,x.jE)(),[c,v]=(0,t.useState)(0),N=(0,u.mN)({resolver:(0,m.u)(orderFormSchema),defaultValues:{quantity:1}});N.watch("quantity");let w=(0,p.n)({mutationFn:async e=>{if(!s||!d)throw Error("Missing required data");let r={product_id:s[0],seller_id:s[1],quantity:e.quantity,total_price:s[5]*e.quantity};return(0,y.FQ)({email:d.email,action:"create",data:r},"orders")},onSuccess:e=>{e.success?(n({title:"Pesanan berhasil dibuat!",description:"Pesanan Anda telah diterima"}),o.invalidateQueries({queryKey:["/api/products"]}),r()):n({title:"Gagal membuat pesanan",description:e.error||"Terjadi kesalahan",variant:"destructive"})},onError:()=>{n({title:"Gagal membuat pesanan",description:"Terjadi kesalahan saat membuat pesanan",variant:"destructive"})}}),k=N.handleSubmit(e=>{w.mutate(e)});if(!s)return null;let[A,q,P,C,S,_,E]=s;return(0,a.jsx)(h.lG,{open:e,onOpenChange:()=>{N.reset({quantity:1}),r()},children:(0,a.jsxs)(h.Cf,{className:"max-w-md",children:[(0,a.jsx)(h.c7,{children:(0,a.jsx)(h.L3,{children:"Pesan Produk"})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:[C?(0,a.jsx)("img",{src:C.includes("drive.google.com/uc?")?C.replace("uc?export=view&id=","thumbnail?id=").concat("&sz=w400-h400"):C,alt:P,className:"w-full h-full object-cover",onError:e=>{console.log("Image failed to load:",C),e.currentTarget.style.display="none",e.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,(0,a.jsx)("div",{className:`w-full h-full flex items-center justify-center ${C?"hidden":""}`,children:(0,a.jsx)(f.A,{className:"h-8 w-8 text-gray-400"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:P}),(0,a.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:S||"Tidak ada deskripsi"}),(0,a.jsx)("p",{className:"text-xl font-bold text-primary mt-1",children:(0,y.$g)(_)}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Stok tersedia: ",E]})]})]}),(0,a.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"quantity",children:"Jumlah"}),(0,a.jsx)(l.p,{id:"quantity",type:"number",min:"1",max:E,...N.register("quantity",{valueAsNumber:!0}),error:N.formState.errors.quantity?.message})]}),(0,a.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Harga:"}),(0,a.jsx)("span",{className:"text-xl font-bold text-primary",children:(0,y.$g)(c)})]})}),(0,a.jsx)(i.$,{type:"submit",className:"w-full",disabled:w.isPending,children:w.isPending?"Memproses...":"Pesan Sekarang"})]})]})]})})}var N=s(1057),w=s(5541),k=s(9270);let A=(0,s(2688).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function q(){let{toast:e}=(0,b.dj)(),[r,s]=(0,t.useState)(""),[u,m]=(0,t.useState)(""),[x,p]=(0,t.useState)(""),[h,g]=(0,t.useState)(null),[j,f]=(0,t.useState)(!1),{data:q=[],isLoading:P,refetch:C}=(0,n.I)({queryKey:["products"],queryFn:async()=>{let e=await (0,y.FQ)({action:"read",table:"products"});return e.success?e.data:[]}}),S=(0,t.useMemo)(()=>q&&Array.isArray(q)?q.filter(e=>{if(!Array.isArray(e)||e.length<9)return!1;let[,,s,,a,t,n,l,i]=e;if(1!==i||n<=0)return!1;if(r){let e=r.toLowerCase();if(!s?.toLowerCase().includes(e)&&!a?.toLowerCase().includes(e)&&!l?.toLowerCase().includes(e))return!1}if(u&&l!==u)return!1;if(x){let e=parseFloat(t)||0;switch(x){case"0-50":if(e>50)return!1;break;case"50-100":if(e<50||e>100)return!1;break;case"100-200":if(e<100||e>200)return!1;break;case"200+":if(e<200)return!1}}return!0}):[],[q,r,u,x]),_=(0,t.useMemo)(()=>{if(!q||!Array.isArray(q))return[];let e=new Set;return q.forEach(r=>{if(Array.isArray(r)&&r.length>=8){let s=r[7];s&&"string"==typeof s&&e.add(s)}}),Array.from(e)},[q]),E=e=>{g(e),f(!0)},R=()=>{s(""),m(""),p("")};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-8 border border-green-100",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:[(0,a.jsx)(N.A,{className:"inline-block w-8 h-8 mr-3 text-green-600"}),"Marketplace Produk"]}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Temukan produk berkelanjutan dari penjual terverifikasi"})]}),(0,a.jsx)("div",{className:"mt-6 sm:mt-0 flex items-center gap-4",children:(0,a.jsxs)(d.E,{variant:"secondary",className:"text-lg px-4 py-2 bg-white/80",children:[(0,a.jsx)(w.A,{className:"w-4 h-4 mr-2"}),S.length," produk tersedia"]})})]})}),(0,a.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border border-gray-100",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(k.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsx)(l.p,{placeholder:"Cari produk, kategori, atau penjual...",value:r,onChange:e=>s(e.target.value),className:"pl-12 h-12 bg-white border-gray-200 focus:border-green-500 focus:ring-green-500"})]}),(0,a.jsxs)(o.l6,{value:u,onValueChange:m,children:[(0,a.jsx)(o.bq,{className:"h-12 bg-white border-gray-200 focus:border-green-500",children:(0,a.jsx)(o.yv,{placeholder:"Semua Kategori"})}),(0,a.jsxs)(o.gC,{children:[(0,a.jsx)(o.eb,{value:"",children:"Semua Kategori"}),_.map(e=>(0,a.jsx)(o.eb,{value:e,children:e},e))]})]}),(0,a.jsxs)(o.l6,{value:x,onValueChange:p,children:[(0,a.jsx)(o.bq,{className:"h-12 bg-white border-gray-200 focus:border-green-500",children:(0,a.jsx)(o.yv,{placeholder:"Rentang Harga"})}),(0,a.jsxs)(o.gC,{children:[(0,a.jsx)(o.eb,{value:"",children:"Semua Harga"}),(0,a.jsx)(o.eb,{value:"0-50",children:"Rp 0 - Rp 50.000"}),(0,a.jsx)(o.eb,{value:"50-100",children:"Rp 50.000 - Rp 100.000"}),(0,a.jsx)(o.eb,{value:"100-200",children:"Rp 100.000 - Rp 200.000"}),(0,a.jsx)(o.eb,{value:"200+",children:"Rp 200.000+"})]})]}),(0,a.jsxs)(i.$,{variant:"outline",onClick:R,className:"h-12 flex items-center gap-2 bg-white hover:bg-gray-50 border-gray-200",children:[(0,a.jsx)(A,{className:"h-4 w-4"}),"Hapus Filter"]})]})}),P?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:[...Array(8)].map((e,r)=>(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-gray-100 animate-pulse",children:[(0,a.jsx)("div",{className:"bg-gray-200 h-56 rounded-xl mb-6"}),(0,a.jsx)("div",{className:"bg-gray-200 h-4 rounded mb-3"}),(0,a.jsx)("div",{className:"bg-gray-200 h-4 rounded w-2/3"})]},r))}):S.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:S.map((e,r)=>(0,a.jsx)(c.A,{product:e,onOrder:E},`${e[0]}-${r}`))}):(0,a.jsx)("div",{className:"text-center py-16",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,a.jsx)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(k.A,{className:"h-12 w-12 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Tidak ada produk ditemukan"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6 text-lg",children:"Coba sesuaikan kriteria pencarian atau filter untuk menemukan yang Anda cari."}),(0,a.jsx)(i.$,{onClick:R,variant:"outline",size:"lg",children:"Hapus semua filter"})]})}),(0,a.jsx)(v,{isOpen:j,onClose:()=>f(!1),product:h})]})}},4385:(e,r,s)=>{Promise.resolve().then(s.bind(s,5928))},5147:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o});var a=s(5239),t=s(8088),n=s(8170),l=s.n(n),i=s(893),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(r,d);let o={children:["",{children:["buyer",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5928)),"/home/runner/workspace/src/app/buyer/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4431)),"/home/runner/workspace/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/home/runner/workspace/src/app/buyer/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/buyer/page",pathname:"/buyer",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5928:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});let a=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/runner/workspace/src/app/buyer/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/runner/workspace/src/app/buyer/page.tsx","default")},7537:(e,r,s)=>{Promise.resolve().then(s.bind(s,4231))},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),a=r.X(0,[447,719,802,884,134,735,557,794],()=>s(5147));module.exports=a})();