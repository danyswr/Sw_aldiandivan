(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[246],{1375:(e,a,r)=>{Promise.resolve().then(r.bind(r,8763))},6151:(e,a,r)=>{"use strict";r.d(a,{A:()=>s});let s=(0,r(9946).A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]])},7924:(e,a,r)=>{"use strict";r.d(a,{A:()=>s});let s=(0,r(9946).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},8763:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>S});var s=r(5155),l=r(2115),t=r(2960),i=r(2523),n=r(285),d=r(6126),c=r(9409),o=r(3184),u=r(2177),m=r(221),h=r(6715),x=r(5041),g=r(4165),p=r(5057),j=r(7481),b=r(3999),y=r(5731),f=r(7213);function v(e){var a;let{isOpen:r,onClose:t,product:d}=e,{toast:c}=(0,j.dj)(),{user:o}=(0,b.A)(),v=(0,h.jE)(),[N,k]=(0,l.useState)(0),w=(0,u.mN)({resolver:(0,m.u)(orderFormSchema),defaultValues:{quantity:1}}),A=w.watch("quantity");(0,l.useEffect)(()=>{d&&A&&k(d[5]*A)},[d,A]);let S=(0,x.n)({mutationFn:async e=>{if(!d||!o)throw Error("Missing required data");let a={product_id:d[0],seller_id:d[1],quantity:e.quantity,total_price:d[5]*e.quantity};return(0,y.FQ)({email:o.email,action:"create",data:a},"orders")},onSuccess:e=>{e.success?(c({title:"Pesanan berhasil dibuat!",description:"Pesanan Anda telah diterima"}),v.invalidateQueries({queryKey:["/api/products"]}),t()):c({title:"Gagal membuat pesanan",description:e.error||"Terjadi kesalahan",variant:"destructive"})},onError:()=>{c({title:"Gagal membuat pesanan",description:"Terjadi kesalahan saat membuat pesanan",variant:"destructive"})}}),q=w.handleSubmit(e=>{S.mutate(e)});if(!d)return null;let[C,E,F,P,_,M,R]=d;return(0,s.jsx)(g.lG,{open:r,onOpenChange:()=>{w.reset({quantity:1}),t()},children:(0,s.jsxs)(g.Cf,{className:"max-w-md",children:[(0,s.jsx)(g.c7,{children:(0,s.jsx)(g.L3,{children:"Pesan Produk"})}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsxs)("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0",children:[P?(0,s.jsx)("img",{src:P.includes("drive.google.com/uc?")?P.replace("uc?export=view&id=","thumbnail?id=").concat("&sz=w400-h400"):P,alt:F,className:"w-full h-full object-cover",onError:e=>{var a;console.log("Image failed to load:",P),e.currentTarget.style.display="none",null==(a=e.currentTarget.nextElementSibling)||a.classList.remove("hidden")}}):null,(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center ".concat(P?"hidden":""),children:(0,s.jsx)(f.A,{className:"h-8 w-8 text-gray-400"})})]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:F}),(0,s.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2",children:_||"Tidak ada deskripsi"}),(0,s.jsx)("p",{className:"text-xl font-bold text-primary mt-1",children:(0,y.$g)(M)}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Stok tersedia: ",R]})]})]}),(0,s.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(p.J,{htmlFor:"quantity",children:"Jumlah"}),(0,s.jsx)(i.p,{id:"quantity",type:"number",min:"1",max:R,...w.register("quantity",{valueAsNumber:!0}),error:null==(a=w.formState.errors.quantity)?void 0:a.message})]}),(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-medium",children:"Total Harga:"}),(0,s.jsx)("span",{className:"text-xl font-bold text-primary",children:(0,y.$g)(N)})]})}),(0,s.jsx)(n.$,{type:"submit",className:"w-full",disabled:S.isPending,children:S.isPending?"Memproses...":"Pesan Sekarang"})]})]})]})})}var N=r(6151),k=r(3109),w=r(7924);let A=(0,r(9946).A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function S(){let{toast:e}=(0,j.dj)(),[a,r]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),[h,x]=(0,l.useState)(""),[g,p]=(0,l.useState)(null),[b,f]=(0,l.useState)(!1),{data:S=[],isLoading:q,refetch:C}=(0,t.I)({queryKey:["products"],queryFn:async()=>{let e=await (0,y.FQ)({action:"read",table:"products"});return e.success?e.data:[]}}),E=(0,l.useMemo)(()=>S&&Array.isArray(S)?S.filter(e=>{if(!Array.isArray(e)||e.length<9)return!1;let[,,r,,s,l,t,i,n]=e;if(1!==n||t<=0)return!1;if(a){let e=a.toLowerCase();if(!(null==r?void 0:r.toLowerCase().includes(e))&&!(null==s?void 0:s.toLowerCase().includes(e))&&!(null==i?void 0:i.toLowerCase().includes(e)))return!1}if(u&&i!==u)return!1;if(h){let e=parseFloat(l)||0;switch(h){case"0-50":if(e>50)return!1;break;case"50-100":if(e<50||e>100)return!1;break;case"100-200":if(e<100||e>200)return!1;break;case"200+":if(e<200)return!1}}return!0}):[],[S,a,u,h]),F=(0,l.useMemo)(()=>{if(!S||!Array.isArray(S))return[];let e=new Set;return S.forEach(a=>{if(Array.isArray(a)&&a.length>=8){let r=a[7];r&&"string"==typeof r&&e.add(r)}}),Array.from(e)},[S]),P=e=>{p(e),f(!0)},_=()=>{r(""),m(""),x("")};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-2xl p-8 border border-green-100",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:[(0,s.jsx)(N.A,{className:"inline-block w-8 h-8 mr-3 text-green-600"}),"Marketplace Produk"]}),(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Temukan produk berkelanjutan dari penjual terverifikasi"})]}),(0,s.jsx)("div",{className:"mt-6 sm:mt-0 flex items-center gap-4",children:(0,s.jsxs)(d.E,{variant:"secondary",className:"text-lg px-4 py-2 bg-white/80",children:[(0,s.jsx)(k.A,{className:"w-4 h-4 mr-2"}),E.length," produk tersedia"]})})]})}),(0,s.jsx)("div",{className:"bg-white/80 backdrop-blur-sm p-8 rounded-2xl shadow-lg border border-gray-100",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(w.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,s.jsx)(i.p,{placeholder:"Cari produk, kategori, atau penjual...",value:a,onChange:e=>r(e.target.value),className:"pl-12 h-12 bg-white border-gray-200 focus:border-green-500 focus:ring-green-500"})]}),(0,s.jsxs)(c.l6,{value:u,onValueChange:m,children:[(0,s.jsx)(c.bq,{className:"h-12 bg-white border-gray-200 focus:border-green-500",children:(0,s.jsx)(c.yv,{placeholder:"Semua Kategori"})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"",children:"Semua Kategori"}),F.map(e=>(0,s.jsx)(c.eb,{value:e,children:e},e))]})]}),(0,s.jsxs)(c.l6,{value:h,onValueChange:x,children:[(0,s.jsx)(c.bq,{className:"h-12 bg-white border-gray-200 focus:border-green-500",children:(0,s.jsx)(c.yv,{placeholder:"Rentang Harga"})}),(0,s.jsxs)(c.gC,{children:[(0,s.jsx)(c.eb,{value:"",children:"Semua Harga"}),(0,s.jsx)(c.eb,{value:"0-50",children:"Rp 0 - Rp 50.000"}),(0,s.jsx)(c.eb,{value:"50-100",children:"Rp 50.000 - Rp 100.000"}),(0,s.jsx)(c.eb,{value:"100-200",children:"Rp 100.000 - Rp 200.000"}),(0,s.jsx)(c.eb,{value:"200+",children:"Rp 200.000+"})]})]}),(0,s.jsxs)(n.$,{variant:"outline",onClick:_,className:"h-12 flex items-center gap-2 bg-white hover:bg-gray-50 border-gray-200",children:[(0,s.jsx)(A,{className:"h-4 w-4"}),"Hapus Filter"]})]})}),q?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:[...Array(8)].map((e,a)=>(0,s.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm p-6 rounded-2xl shadow-lg border border-gray-100 animate-pulse",children:[(0,s.jsx)("div",{className:"bg-gray-200 h-56 rounded-xl mb-6"}),(0,s.jsx)("div",{className:"bg-gray-200 h-4 rounded mb-3"}),(0,s.jsx)("div",{className:"bg-gray-200 h-4 rounded w-2/3"})]},a))}):E.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8",children:E.map((e,a)=>(0,s.jsx)(o.A,{product:e,onOrder:P},"".concat(e[0],"-").concat(a)))}):(0,s.jsx)("div",{className:"text-center py-16",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,s.jsx)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(w.A,{className:"h-12 w-12 text-gray-400"})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Tidak ada produk ditemukan"}),(0,s.jsx)("p",{className:"text-gray-500 mb-6 text-lg",children:"Coba sesuaikan kriteria pencarian atau filter untuk menemukan yang Anda cari."}),(0,s.jsx)(n.$,{onClick:_,variant:"outline",size:"lg",children:"Hapus semua filter"})]})}),(0,s.jsx)(v,{isOpen:b,onClose:()=>f(!1),product:g})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[455,977,399,112,12,732,699,719,757,620,441,684,358],()=>a(1375)),_N_E=e.O()}]);